<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kpet.mapper.UserMapper">

	<insert id="join" parameterType="com.kpet.domain.UserVO">
		
		INSERT INTO user_tbl(
			user_id, 
			user_pw, 
			user_name,
			user_postcode,
			user_addr,
			user_deaddr, 
			user_phone, 
			user_email,
			user_emailrec
			)
		VALUES(
			#{user_id},
			#{user_pw},
			#{user_name},
			#{user_postcode},
			#{user_addr},
			#{user_deaddr},
			#{user_phone},
			#{user_email},
			#{user_emailrec}
		)
		
	</insert>
	
	<select id="checkID" resultType="string">
	
		SELECT 
			user_id 
		FROM 
			user_tbl
		WHERE 
			user_id = #{user_id}
	
	</select>
	
	<select id="login" resultType="com.kpet.domain.UserVO">
	
		SELECT
			user_id, user_pw, user_name, user_email, user_postcode, user_addr, user_deaddr, user_phone, user_email, user_emailrec, user_regdate, user_updatedate, user_lastlogin
		FROM
			user_tbl
		WHERE 
			user_id = #{user_id}
	
	</select>
	
	<select id="searchPwByEmail" resultType="string">
	
		SELECT 
			user_email 
		FROM 
			user_tbl
		WHERE 
			user_email = #{user_email}
	
	</select>
	
	<select id="searchIdByEmail" resultType="string">
	
		SELECT 
			user_id 
		FROM 
			user_tbl
		WHERE 
			user_email = #{user_email}
	
	</select>
	
	<select id="currentPwConfirm" resultType="string">
	
		SELECT 
			user_pw 
		FROM 
			user_tbl
		WHERE 
			user_id = #{user_id} 
	
	</select>
	
		<update id="changePw">
	
		UPDATE
			user_tbl
		SET 
			user_pw = #{user_pw}
		WHERE
			user_email = #{user_email}
	
	</update>
	
	<update id="changeNewPw">
	
		UPDATE
			user_tbl
		SET 
			user_pw = #{change_user_pw}
		WHERE
			user_id = #{user_id}
	
	</update>
	
	<update id="modify">
	
		UPDATE
			user_tbl
		SET
			user_pw = #{user_pw}, 
			user_email = #{user_email}, 
			user_postcode = #{user_postcode}, 
			user_addr = #{user_addr}, 
			user_deaddr = #{user_deaddr}, 
			user_phone = #{user_phone},
			user_emailrec = #{user_emailrec},
			user_updatedate = sysdate
			
		WHERE
			user_id = #{user_id}
	
	</update>
	
	<delete id="regDelete">
	
		DELETE FROM
			user_tbl
		WHERE
			user_id = #{user_id}
	
	</delete>
	
	<update id="updateLastlogin">
	
		UPDATE
			user_tbl 
		SET
			user_lastlogin = #{user_lastlogin} 
		WHERE
			user_id = #{user_id} 
	
	</update>
	
</mapper>  